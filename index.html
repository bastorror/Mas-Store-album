<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡πâ‡∏≤‡∏ô‡∏°‡∏≤‡∏®‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>‡∏£‡πâ‡∏≤‡∏ô‡∏°‡∏≤‡∏®‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤</h1>
            <p class="subtitle">‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡∏Å‡∏ä‡∏±‡∏ô‡∏Ç‡∏ô‡∏°</p>
        </div>
    </header>

    <nav class="category-nav">
        <div class="container">
            <div class="nav-buttons" id="category-buttons">
                <!-- Navigation buttons will be generated automatically from JSON -->
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="search-container">
            <input type="text" class="search-box" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡∏ô‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏≠‡∏ö..." onkeyup="searchSnacks()">
        </div>

        <!-- Dynamic content will be loaded here -->
        <div id="snack-categories"></div>
    </div>

    <!-- Modal for displaying snack details -->
    <div id="snackModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-image" id="modalImage">
                <!-- Image or emoji will be inserted here -->
            </div>
            <div class="modal-info">
                <h2 class="modal-title" id="modalTitle"></h2>
                <p class="modal-description" id="modalDescription"></p>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 ‡∏£‡πâ‡∏≤‡∏ô‡∏°‡∏≤‡∏™ ‡∏™‡∏á‡∏ß‡∏ô‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå | ‡∏Ç‡∏ô‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô</p>
        </div>
    </footer>

    <script>
        let snacksData = {};
        let currentCategory = 'all';

        // Load snacks data from JSON file
        async function loadSnacksData() {
            try {
                const response = await fetch('snacks-data.json');
                snacksData = await response.json();
                generateNavigationButtons();
                renderCategories();
                setupEventListeners();
            } catch (error) {
                console.error('Error loading snacks data:', error);
                // Fallback: show error message
                document.getElementById('snack-categories').innerHTML = 
                    '<p style="text-align: center; color: #666; margin: 50px 0;">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏ô‡∏°‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>';
            }
        }

        // Generate navigation buttons from JSON data
        function generateNavigationButtons() {
            const buttonContainer = document.getElementById('category-buttons');
            let buttonsHTML = '';

            // Add "All" button first (stays on main page)
            buttonsHTML += '<button class="nav-btn active" onclick="showCategory(\'all\')">‡∏Ç‡∏ô‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>';

            // Add buttons for each category that link to individual pages
            for (const [categoryId, category] of Object.entries(snacksData.categories)) {
                buttonsHTML += `<button class="nav-btn" onclick="window.location.href='${categoryId}.html'">${category.emoji} ${category.name}</button>`;
            }

            buttonContainer.innerHTML = buttonsHTML;
        }

        // Render all categories and their items
        function renderCategories() {
            const container = document.getElementById('snack-categories');
            let html = '';

            for (const [categoryId, category] of Object.entries(snacksData.categories)) {
                html += `
                    <section class="category-section" id="${categoryId}-section">
                        <h2 class="category-title">${category.emoji} ${category.name}</h2>
                        <div class="snack-grid">
                            ${category.items.map(item => createSnackCard(item, categoryId)).join('')}
                        </div>
                    </section>
                `;
            }

            container.innerHTML = html;
        }

        // Create HTML for a single snack card
        function createSnackCard(item, categoryId) {
            const hasImage = item.image && item.image.trim() !== '';
            const imageContent = hasImage 
                ? `<img src="${item.image}" alt="${item.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">`
                : '';
            const fallbackEmoji = `<span class="emoji-fallback" style="display: ${hasImage ? 'none' : 'flex'}">${item.emoji}</span>`;
            
            return `
                <div class="snack-card" data-category="${categoryId}" data-name="${item.name.toLowerCase()}" data-id="${item.id}">
                    <div class="snack-image">
                        ${imageContent}
                        ${fallbackEmoji}
                    </div>
                    <div class="snack-info">
                        <h3 class="snack-name">${item.name}</h3>
                        <p class="snack-description">${item.description}</p>
                        <span class="price-tag">${item.price}</span>
                    </div>
                </div>
            `;
        }

        // Setup event listeners after content is loaded
        function setupEventListeners() {
            // Add click event to snack cards for interaction
            document.querySelectorAll('.snack-card').forEach(card => {
                card.addEventListener('click', function() {
                    const itemId = this.getAttribute('data-id');
                    const categoryId = this.getAttribute('data-category');
                    showSnackModal(itemId, categoryId);
                });
            });

            // Add smooth scrolling for navigation buttons
            document.querySelectorAll('.nav-btn').forEach(button => {
                button.addEventListener('click', function() {
                    setTimeout(() => {
                        const firstVisibleSection = document.querySelector('.category-section:not([style*="display: none"])');
                        if (firstVisibleSection) {
                            firstVisibleSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }, 100);
                });
            });

            // Setup modal close functionality
            setupModalEventListeners();
        }

        // Show modal with snack details
        function showSnackModal(itemId, categoryId) {
            const item = snacksData.categories[categoryId].items.find(item => item.id === itemId);
            if (!item) return;

            const modal = document.getElementById('snackModal');
            const modalImage = document.getElementById('modalImage');
            const modalTitle = document.getElementById('modalTitle');
            const modalDescription = document.getElementById('modalDescription');

            // Set title and description
            modalTitle.textContent = item.name;
            modalDescription.textContent = item.description;

            // Set image or emoji
            const hasImage = item.image && item.image.trim() !== '';
            if (hasImage) {
                modalImage.innerHTML = `<img src="${item.image}" alt="${item.name}" onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=\\'emoji-large\\'>${item.emoji}</div>';">`;
            } else {
                modalImage.innerHTML = `<div class="emoji-large">${item.emoji}</div>`;
            }

            // Show modal
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }

        // Setup modal event listeners
        function setupModalEventListeners() {
            const modal = document.getElementById('snackModal');
            const closeBtn = document.querySelector('.close');

            // Close modal when clicking the X button
            closeBtn.addEventListener('click', closeModal);

            // Close modal when clicking outside of it
            modal.addEventListener('click', function(event) {
                if (event.target === modal) {
                    closeModal();
                }
            });

            // Close modal with Escape key
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && modal.style.display === 'block') {
                    closeModal();
                }
            });
        }

        // Close modal function
        function closeModal() {
            const modal = document.getElementById('snackModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto'; // Restore background scrolling
        }

        // Category filtering functionality
        function showCategory(category) {
            const sections = document.querySelectorAll('.category-section');
            const buttons = document.querySelectorAll('.nav-btn');
            currentCategory = category;

            // Update active button
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            if (category === 'all') {
                sections.forEach(section => {
                    section.style.display = 'block';
                    section.classList.add('fade-in');
                });
            } else {
                sections.forEach(section => {
                    if (section.id === category + '-section') {
                        section.style.display = 'block';
                        section.classList.add('fade-in');
                    } else {
                        section.style.display = 'none';
                    }
                });
            }
        }

        // Search functionality
        function searchSnacks() {
            const searchTerm = document.querySelector('.search-box').value.toLowerCase();
            const cards = document.querySelectorAll('.snack-card');
            const sections = document.querySelectorAll('.category-section');

            if (searchTerm === '') {
                // Show all sections if search is empty
                sections.forEach(section => section.style.display = 'block');
                cards.forEach(card => card.style.display = 'block');
                return;
            }

            let hasVisibleCards = {};

            cards.forEach(card => {
                const snackName = card.getAttribute('data-name');
                const category = card.getAttribute('data-category');
                
                if (snackName.includes(searchTerm)) {
                    card.style.display = 'block';
                    hasVisibleCards[category] = true;
                } else {
                    card.style.display = 'none';
                }
            });

            // Hide sections that have no visible cards
            sections.forEach(section => {
                const sectionCategory = section.id.replace('-section', '');
                if (hasVisibleCards[sectionCategory]) {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });
        }

        // Load data when page loads
        document.addEventListener('DOMContentLoaded', loadSnacksData);
    </script>
</body>
</html>